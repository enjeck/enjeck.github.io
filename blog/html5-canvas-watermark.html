<!DOCTYPE html><!--J4CUv_BJLZ_ivLom0QHcs--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"/><link rel="preload" as="image" href="/_next/static/media/stroke-logo.841d3044.png"/><link rel="preload" href="/filled-rect.png" as="image"/><link rel="preload" href="/watermark-interface.png" as="image"/><link rel="preload" href="/load-image-watermark.png" as="image"/><link rel="preload" href="/watermarked-image.png" as="image"/><link rel="preload" href="/font-test.png" as="image"/><link rel="stylesheet" href="/_next/static/chunks/e5da751912c10467.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/chunks/e2fae31b48403321.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/chunks/69ef5a39cc4d8dfb.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/5fcaeda216ddf010.js"/><script src="/_next/static/chunks/6e0c27244cc63000.js" async=""></script><script src="/_next/static/chunks/f3867d4abef22577.js" async=""></script><script src="/_next/static/chunks/bbbd2a27da7d8d6f.js" async=""></script><script src="/_next/static/chunks/turbopack-b95ed7d881ce3c54.js" async=""></script><script src="/_next/static/chunks/b42444546cf1924e.js" async=""></script><script src="/_next/static/chunks/8578e6e2b7d87452.js" async=""></script><script src="/_next/static/chunks/0b32bff5a2dff718.js" async=""></script><script src="/_next/static/chunks/cbec149b17a636bf.js" async=""></script><script src="/_next/static/chunks/ad06993566a63284.js" async=""></script><link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css" as="style"/><link rel="preload" href="https://www.googletagmanager.com/gtag/js?id=G-W8GSQN5XSZ" as="script"/><title>Learn HTML5 canvas by building an image watermarking tool | Enjeck</title><meta name="description" content="HTML5 canvas allows us to create and manipulate pixels, just like a painter working on a canvas. We can draw text and graphics onto the canvas using JavaS"/><link rel="author" href="https://enjeck.github.io"/><meta name="author" content="Enjeck"/><meta name="keywords" content="JavaScript,HTML"/><meta name="creator" content="Enjeck"/><meta name="robots" content="index, follow"/><meta name="googlebot" content="index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"/><meta property="og:title" content="Learn HTML5 canvas by building an image watermarking tool"/><meta property="og:description" content="HTML5 canvas allows us to create and manipulate pixels, just like a painter working on a canvas. We can draw text and graphics onto the canvas using JavaS"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2022-03-15"/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Learn HTML5 canvas by building an image watermarking tool"/><meta name="twitter:description" content="HTML5 canvas allows us to create and manipulate pixels, just like a painter working on a canvas. We can draw text and graphics onto the canvas using JavaS"/><link rel="icon" href="/favicon.ico?favicon.0b3bf435.ico" sizes="256x256" type="image/x-icon"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"WebSite","name":"Enjeck's Portfolio","url":"https://enjeck.github.io","author":{"@type":"Person","name":"Enjeck"}}</script><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body><div hidden=""><!--$--><!--/$--></div><div class="reading-progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="Reading progress"><div class="reading-progress-fill" style="width:0%"></div></div><div class="layout-container"><div class="toggle-menu"><div class="menu-options"><a href="/" class="logo"><img style="margin-bottom:0" src="/_next/static/media/stroke-logo.841d3044.png" alt="Home"/></a><button class="hamburger-icon" aria-label="Toggle navigation menu"><span></span><span></span><span></span></button></div><div class="toggle-menu-items menu-hide"><a class="toggle-menu-item" href="/#about"> About </a><a class="toggle-menu-item" href="/#works"> Works </a><a class="toggle-menu-item" href="/#contact"> Contact </a><a class="toggle-menu-item" href="/blog"> Blog </a></div></div><main><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"Learn HTML5 canvas by building an image watermarking tool","datePublished":"2022-03-15","author":{"@type":"Person","name":"Enjeck"},"publisher":{"@type":"Person","name":"Enjeck"}}</script><article class="blogpost-content"><div class="centered"><a style="border-bottom:2px dotted var(--dark-black);padding:10px 20px" href="/blog">‚Üê Back to blog</a><h1 class="blogpost-title"><span>Learn HTML5 canvas by building an image watermarking tool</span></h1><div class="post-meta"><time class="date" dateTime="2022-03-15">2022-03-15</time><span class="reading-time">14<!-- --> min read</span></div></div><div class="blog-body"><p>HTML5 canvas allows us to create and manipulate pixels, just like a painter working on a canvas. We can draw text and graphics onto the canvas using JavaScript. To demonstrate its power, let&#x27;s build an image watermarking tool that allows a user to upload an image and watermark it with text.</p>
<h2>Adding the canvas into a web page</h2>
<p>Before you begin, create a file called <code>index.html</code>. Here, we will write most of our code.</p>
<p>The HTML5 canvas can be added to a page just like any other element. It starts with an opening <code>&lt;canvas&gt;</code> tag and closes with <code>&lt;/canvas&gt;</code>. Like other HTML elements, it can take attributes like <code>id</code> for identification, <code>width</code> to define the horizontal length in pixels, and <code>height</code> to define the vertical area of the page it occupies.</p>
<p>The canvas in the following code is 600 pixels wide and 600 pixels high.</p>
<pre class="prism-code language-html" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token doctype punctuation" style="color:#6c6783">&lt;!</span><span class="token doctype doctype-tag" style="color:#6c6783">doctype</span><span class="token doctype" style="color:#6c6783"> </span><span class="token doctype name" style="color:#6c6783">html</span><span class="token doctype punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">html</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">lang</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">en</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">head</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">title</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain">Watermark</span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">title</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">meta</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">charset</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">utf-8</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">head</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">body</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">canvas</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">canvas</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">width</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">600</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">height</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">600</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">canvas</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">body</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">style</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token style language-css"></span></div><div class="token-line" style="color:#9a86fd"><span class="token style language-css">        </span><span class="token style language-css selector" style="color:#eeebff">canvas</span><span class="token style language-css"> </span><span class="token style language-css punctuation" style="color:#6c6783">{</span><span class="token style language-css"></span></div><div class="token-line" style="color:#9a86fd"><span class="token style language-css">            </span><span class="token style language-css property" style="color:#9a86fd">border</span><span class="token style language-css punctuation" style="color:#6c6783">:</span><span class="token style language-css"> </span><span class="token style language-css number" style="color:#e09142">1</span><span class="token style language-css unit" style="color:#ffcc99">px</span><span class="token style language-css"> solid </span><span class="token style language-css hexcode color">#000</span><span class="token style language-css punctuation" style="color:#6c6783">;</span><span class="token style language-css"></span></div><div class="token-line" style="color:#9a86fd"><span class="token style language-css">        </span><span class="token style language-css punctuation" style="color:#6c6783">}</span><span class="token style language-css"></span></div><div class="token-line" style="color:#9a86fd"><span class="token style language-css">    </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">style</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">script</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#9a86fd"><span class="token script language-javascript">    </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">script</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">html</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span></div></pre>
<p>Go ahead and save the code as an HTML file and load it into a browser.</p>
<p>To see our canvas, we have given it a tiny black border, defined within the <code>style</code> tags. Without this border, a blank white page is shown and we won&#x27;t know exactly where the canvas is. For now, we&#x27;ll write JavaScript code between the <code>script</code> tags.</p>
<p>A page can have as many canvas elements as we like. Since the canvas is transparent, it can be placed on top of other elements. This allows us to draw on top of an image or something else.</p>
<p>Notice that we set the width and height of the canvas as an inline style on the element itself, and not as CSS styles within the <code>&lt;style&gt;</code> tag. That&#x27;s because the <code>height</code> and <code>width</code> attributes work differently with the canvas, compared to other elements. The default dimension of the canvas is 300px by 150px -- it takes these values when the height and width HTML attributes are not explicitly set. If you later set the dimensions in CSS, say 600px by 600px, the canvas scales from its default size of 300 by 150 to fit this size, and everything drawn in the canvas scales with it. This might cause some pixelation issues (pixels get stretched and appear chunky), similar to what occurs when you resize a raster image. By making the canvas bigger (or smaller, if you prefer), anything drawn in it will be scaled to fit the specified dimensions.</p>
<h2>Drawing on the canvas</h2>
<p>Let&#x27;s begin writing some JavaScript between our script tags:</p>
<pre class="prism-code language-js" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token comment" style="color:#6c6783">// Start drawing after the page is fully loaded. </span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">     </span><span class="token dom variable" style="color:#ffcc99">window</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method-variable function-variable method function property-access" style="color:#9a86fd">onload</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">function</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">     </span><span class="token comment" style="color:#6c6783">// Get the canvas element, where we shall draw the background elements. </span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">       </span><span class="token keyword" style="color:#ffcc99">const</span><span class="token plain"> canvas </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#ffcc99">document</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">getElementById</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;canvas&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">       </span><span class="token comment" style="color:#6c6783">// To draw, we need to select a context for the canvas, 2d in this case, since we&#x27;re drawing 2d items. </span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">const</span><span class="token plain"> context </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> canvas</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">getContext</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;2d&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">     </span><span class="token punctuation" style="color:#6c6783">}</span></div></pre>
<p>In the code above, we get the canvas element we created. Before we can draw, we must set an interface by getting a context. The context defines the properties and methods used to draw on the canvas. Here, we use a 2D context.</p>
<p>Using JavaScript to check for canvas support might be a bit of an overkill, depending on what you are trying to do. JavaScript&#x27;s power comes into play when you want to provide users with a different experience (such as displaying another content or redirecting to another page) when there&#x27;s no canvas support.</p>
<p>If you intend to just display some backup text when the canvas is not supported, it suffices to just use plain HTML.</p>
<p>When a supported element (such as text or image) is placed within the canvas element, it will be displayed if the canvas is not supported. By default, whenever a browser sees an element it does not recognize, it displays any text within the element.</p>
<pre class="prism-code language-html" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">canvas</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">canvas</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">No canvas support. Please upgrade. </span></div><div class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">canvas</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span></div></pre>
<p>With the code above, browsers without canvas support will display the text &quot;No canvas support. Please upgrade&quot;, whereas, capable browsers ignore any text within the canvas tags and instead shows drawings generated via JavaScript.</p>
<h2>Drawing a basic shape</h2>
<p>Before we jump into the main watermarking application, let&#x27;s test the canvas by drawing a simple shape.
To draw a rectangle, we use the <code>fillRect()</code> method. It takes 4 arguments, corresponding to the <em>x position</em>, <em>y position</em>, <em>width</em>, and <em>height</em>.</p>
<pre class="prism-code language-js" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token operator" style="color:#e09142">&lt;</span><span class="token plain">script</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">     </span><span class="token dom variable" style="color:#ffcc99">window</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method-variable function-variable method function property-access" style="color:#9a86fd">onload</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">function</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">       </span><span class="token keyword" style="color:#ffcc99">const</span><span class="token plain"> canvas </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#ffcc99">document</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">getElementById</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;canvas&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> context </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> canvas</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">getContext</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;2d&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">         context</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">fillRect</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token number" style="color:#e09142">100</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token number" style="color:#e09142">100</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">     </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token operator" style="color:#e09142">&lt;</span><span class="token operator" style="color:#e09142">/</span><span class="token plain">script</span><span class="token operator" style="color:#e09142">&gt;</span></div></pre>
<p>The code <code>context.fillRect(0, 0, 100, 100)</code> creates a rectangle starting from the top left, with dimensions 100 x 100 pixels. This rectangle is colored black, which is the default fill color for the canvas.</p>
<p><img src="/filled-rect.png" alt=""/></p>
<p>To draw a rectangle with a stroke rather than fill, we would use the <code>strokeRect()</code> method rather than <code>fillRect()</code>. If you now load <code>index.html</code> in your browser, you should see something like this:</p>
<p>Great, our canvas is up and running. We have tested it out, and it works. Go ahead and delete the <code>context.fillRect(0, 0, 100, 100)</code> code. We don&#x27;t need it anymore.</p>
<h2>Building the app interface</h2>
<p>Before we begin implementing the watermarking app, let&#x27;s consider its interface and features:</p>
<ul>
<li>There is a canvas element, along with form elements that act as the user interface.</li>
<li>The form will have input fields like a &quot;browse&quot; button to upload an image, a text input to enter the watermark text, select fields for choosing the text color, text size, text background, the position of text on the image, and a preview button.</li>
<li>We&#x27;ll grab user input from the form and use it to draw on the canvas using JavaScript.</li>
<li>The preview button will prompt JavaScript to retrieve user input and print data on canvas.</li>
<li>Optionally, we can add a download button for saving the finished watermarked image.</li>
</ul>
<p>To begin with, here&#x27;s the HTML code:</p>
<pre class="prism-code language-html" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token doctype punctuation" style="color:#6c6783">&lt;!</span><span class="token doctype doctype-tag" style="color:#6c6783">doctype</span><span class="token doctype" style="color:#6c6783"> </span><span class="token doctype name" style="color:#6c6783">html</span><span class="token doctype punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">html</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">lang</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">en</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">head</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">title</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain">Watermark</span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">title</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">meta</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">charset</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">utf-8</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag" style="color:#e09142"> </span><span class="token tag punctuation" style="color:#6c6783">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">style</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token style language-css"></span></div><div class="token-line" style="color:#9a86fd"><span class="token style language-css">            </span><span class="token style language-css selector" style="color:#eeebff">canvas</span><span class="token style language-css"> </span><span class="token style language-css punctuation" style="color:#6c6783">{</span><span class="token style language-css"></span></div><div class="token-line" style="color:#9a86fd"><span class="token style language-css">              </span><span class="token style language-css property" style="color:#9a86fd">border</span><span class="token style language-css punctuation" style="color:#6c6783">:</span><span class="token style language-css"> </span><span class="token style language-css number" style="color:#e09142">1</span><span class="token style language-css unit" style="color:#ffcc99">px</span><span class="token style language-css"> solid </span><span class="token style language-css color">black</span><span class="token style language-css punctuation" style="color:#6c6783">;</span><span class="token style language-css"></span></div><div class="token-line" style="color:#9a86fd"><span class="token style language-css">              </span><span class="token style language-css punctuation" style="color:#6c6783">}</span><span class="token style language-css"></span></div><div class="token-line" style="color:#9a86fd"><span class="token style language-css">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">style</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">head</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">body</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">       </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">h1</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"> Watermarker </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">h1</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">canvas</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">canvas</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">width</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">600</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">height</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">400</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">p</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"> No canvas support. Please upgrade your browser. </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">p</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">canvas</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">form</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">form</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">script</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">watermark.js</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">script</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">body</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">html</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span></div></pre>
<p>We have moved our script code to a <code>watermark.js</code> file and linked it to it within the <code>&lt;head&gt;</code>. The canvas still has the fallback text for old browsers that do not support the canvas API.</p>
<p>Also, there is a <code>&lt;form&gt;</code> element containing controls that support the watermarking features.</p>
<p>Let&#x27;s add the <code>&lt;form&gt;</code> data. This form serves as the user interface.</p>
<pre class="prism-code language-html" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">form</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token comment" style="color:#6c6783">&lt;!-- Where the user selects an image --&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">p</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">label</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">for</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">imageLoader</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">imageLoaderLabel</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain">Choose an image:</span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">label</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">br</span><span class="token tag" style="color:#e09142"> </span><span class="token tag punctuation" style="color:#6c6783">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">input</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">file</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">imageLoader</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">imageLoader</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag" style="color:#e09142"> </span><span class="token tag punctuation" style="color:#6c6783">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">p</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token comment" style="color:#6c6783">&lt;!-- Where the user enters the text to be used as a watermark --&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">p</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">label</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">for</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">watermarkText</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain">Enter the text to use:</span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">label</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">br</span><span class="token tag" style="color:#e09142"> </span><span class="token tag punctuation" style="color:#6c6783">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">input</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">text</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">watermarkText</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">watermarkText</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag" style="color:#e09142"> </span><span class="token tag punctuation" style="color:#6c6783">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">p</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token comment" style="color:#6c6783">&lt;!-- Where the user  selects the position of the text on the image. Feel free to add more options--&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">p</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">label</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">for</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">textPosition</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain">Position of text:</span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">label</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">br</span><span class="token tag" style="color:#e09142"> </span><span class="token tag punctuation" style="color:#6c6783">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">select</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">textPosition</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">option</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">bottom-left</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain">Bottom Left</span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">option</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">option</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">center</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"> Center </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">option</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">select</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">p</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token comment" style="color:#6c6783">&lt;!-- Where the user  selects the color of the text on the image. Feel free to add more options--&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">p</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">label</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">for</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">textColor</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain">Color of text:</span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">label</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">br</span><span class="token tag" style="color:#e09142"> </span><span class="token tag punctuation" style="color:#6c6783">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">select</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">textColor</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">option</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">black</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain">black</span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">option</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">option</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">blue</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain">blue</span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">option</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">option</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">red</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain">red</span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">option</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">select</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">p</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token comment" style="color:#6c6783">&lt;!-- Another selection control for choosing the font of the text. Feel free to add more options--&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">p</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">label</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">for</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">textFont</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain">Text font:</span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">label</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">br</span><span class="token tag" style="color:#e09142"> </span><span class="token tag punctuation" style="color:#6c6783">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">select</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">textFont</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">option</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">arial</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain">Arial</span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">option</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">option</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">helvetica</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain">Helvetica</span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">option</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">option</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">monospace</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain">Monospace</span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">option</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">select</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">p</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token comment" style="color:#6c6783">&lt;!-- Another selection control for choosing the color of the text background. Feel free to add more options--&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">p</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">label</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">for</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">textBgColor</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain">Text background color:</span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">label</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">br</span><span class="token tag" style="color:#e09142"> </span><span class="token tag punctuation" style="color:#6c6783">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">select</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">textBgColor</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">option</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">black</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain">black</span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">option</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">option</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">white</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain">white</span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">option</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">option</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">transparent</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain">transparent</span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">option</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">select</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">p</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token comment" style="color:#6c6783">&lt;!-- Buttons to preview or download the watermarked image --&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token tag punctuation" style="color:#6c6783">&lt;</span><span class="token tag" style="color:#e09142">input</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">button</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">previewBtn</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag" style="color:#e09142"> </span><span class="token tag attr-name" style="color:#c4b9fe">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#6c6783">=</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag attr-value" style="color:#ffcc99">Preview</span><span class="token tag attr-value punctuation" style="color:#6c6783">&quot;</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token tag punctuation" style="color:#6c6783">&lt;/</span><span class="token tag" style="color:#e09142">form</span><span class="token tag punctuation" style="color:#6c6783">&gt;</span></div></pre>
<p><img src="/watermark-interface.png" alt=""/></p>
<p>We&#x27;ve dealt with the markup. Now, we can handle the script.</p>
<p>Let&#x27;s start by writing code to load a selected image to the canvas when the &quot;browse...&quot; (<code>id = imageLoader</code>) button is clicked.</p>
<p>Add the following code into <code>watermark.js</code>:</p>
<pre class="prism-code language-js" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token comment" style="color:#6c6783">// Select the &quot;browse&quot; button, used to choose the image</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">const</span><span class="token plain"> imageLoader </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#ffcc99">document</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">getElementById</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&#x27;imageLoader&#x27;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/* When the user selects an image, call the loadImage function */</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    imageLoader</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">addEventListener</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&#x27;change&#x27;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> loadImage</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">// Select the canvas and give it a 2d context </span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">const</span><span class="token plain"> canvas </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#ffcc99">document</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">getElementById</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&#x27;canvas&#x27;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">const</span><span class="token plain"> ctx </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> canvas</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">getContext</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&#x27;2d&#x27;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span></div></pre>
<p>The event listener calls the <code>loadImage()</code> function, which is defined below. It reads the selected image using the <code>FileReader</code> object and draws it onto the canvas using <code>drawImage()</code>.</p>
<pre class="prism-code language-js" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">function</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">loadImage</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token parameter">e</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Read the selected image </span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">const</span><span class="token plain"> reader </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">new</span><span class="token plain"> </span><span class="token class-name">FileReader</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    reader</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method-variable function-variable method function property-access" style="color:#9a86fd">onload</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">function</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">const</span><span class="token plain"> img </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">new</span><span class="token plain"> </span><span class="token class-name">Image</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        img</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method-variable function-variable method function property-access" style="color:#9a86fd">onload</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">function</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token comment" style="color:#6c6783">/* Set the width and height of the canvas to</span></div><div class="token-line" style="color:#9a86fd"><span class="token comment" style="color:#6c6783">             match the size of the chosen image */</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            canvas</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">width</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> img</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">width</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            canvas</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">height</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> img</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">height</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token comment" style="color:#6c6783">// Draw the image on the canvas</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            ctx</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">drawImage</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">img</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        img</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">src</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> event</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">target</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">result</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">/* Delete the image loader with the prompt to &quot;Choose an image&quot; after an image is chosen */</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token dom variable" style="color:#ffcc99">document</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">getElementById</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&#x27;imageLoaderLabel&#x27;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">remove</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    reader</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">readAsDataURL</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">target</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">files</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain">     </span></div><div class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span></div></pre>
<p>If you visit <code>index.html</code> in a browser, you should be able to select an image and it will be loaded to the canvas.</p>
<p><img src="/load-image-watermark.png" alt=""/></p>
<p>Next, let&#x27;s enable the &quot;preview&quot; (<code>id=&quot;previewBtn&quot;</code>) button by making it call a JavaScript function when it is clicked.</p>
<pre class="prism-code language-js" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token dom variable" style="color:#ffcc99">window</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method-variable function-variable method function property-access" style="color:#9a86fd">onload</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">function</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Get the preview button element</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">const</span><span class="token plain"> button </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#ffcc99">document</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">getElementById</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;previewBtn&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/* Add a click handler to the button so that</span></div><div class="token-line" style="color:#9a86fd"><span class="token comment" style="color:#6c6783">    the previewImage function is called when clicked */</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    button</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">onclick</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> previewImage</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token punctuation" style="color:#6c6783">;</span></div></pre>
<p>Now, when the preview button is clicked, the <code>previewImage()</code> function is called. Within this function, we shall later add code to watermark the image loaded into the canvas.</p>
<p>Let&#x27;s start writing the <code>previewImage()</code> function. For the most part, we will use the <code>fillText()</code> method. It takes four arguments, corresponding to the actual text, x position, y position, and optionally, the maximum width of the text). It fills the provided text at the (x, y) position of the canvas. The code <code>context.fillText(&quot;hello&quot;, 100, 100)</code> creates a text &quot;hello&quot; starting 100 pixels from the left and top.</p>
<pre class="prism-code language-js" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">function</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">previewImage</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token comment" style="color:#6c6783">// Select the canvas and give it a 2d context</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> canvas </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#ffcc99">document</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">getElementById</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;canvas&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> ctx </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> canvas</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">getContext</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;2d&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token comment" style="color:#6c6783">/* Get the value of element with an id of &quot;watermarkText&quot; */</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> wmText </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#ffcc99">document</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">getElementById</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;watermarkText&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token comment" style="color:#6c6783">/* If there&#x27;s actually some text*/</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#ffcc99">if</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">wmText</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/* Find out what options the user has chosen by </span></div><div class="token-line" style="color:#9a86fd"><span class="token comment" style="color:#6c6783">    getting the indices of the selected items */</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Get the selected text position </span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> selectPos </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#ffcc99">document</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">getElementById</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;textPosition&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> posIndex </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> selectPos</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">selectedIndex</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> position </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> selectPos</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">posIndex</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Get the selected text color</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> selectCol </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#ffcc99">document</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">getElementById</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;textColor&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> colIndex </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> selectCol</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">selectedIndex</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> color </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> selectCol</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">colIndex</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Get the selected text color </span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> selectFont </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#ffcc99">document</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">getElementById</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;textFont&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> fontIndex </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> selectFont</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">selectedIndex</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> font </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> selectFont</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">fontIndex</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Give text a size of 40px and assign it to the selected font</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> textSize </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">40</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    ctx</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">font</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#ffcc99">`</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#6c6783">${</span><span class="token template-string interpolation">textSize</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#6c6783">}</span><span class="token template-string string" style="color:#ffcc99">px </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#6c6783">${</span><span class="token template-string interpolation">font</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#6c6783">}</span><span class="token template-string template-punctuation string" style="color:#ffcc99">`</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Get the width and height of the canvas</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> w </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> canvas</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">width</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> h </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> canvas</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">height</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Get width of the text</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> text </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">measureText</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">wmText</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> textWidth </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> text</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">width</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Get the selected text background color </span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> selectBgColor </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#ffcc99">document</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">getElementById</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;textBgColor&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> bgIndex </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> selectBgColor</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">selectedIndex</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> bgColor </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> selectBgColor</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">bgIndex</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/* Position the text on the image based on the selected position */</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">position </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token string" style="color:#ffcc99">&quot;center&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// Color the background with the selected color using the fillStyle property</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        ctx</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">fillStyle</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> bgColor</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">/* Draw the background using the fillStyle property. The x, y positions, width</span></div><div class="token-line" style="color:#9a86fd"><span class="token comment" style="color:#6c6783">        and height are based on the width of the text */</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        ctx</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">fillRect</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">w</span><span class="token operator" style="color:#e09142">/</span><span class="token number" style="color:#e09142">2</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">-</span><span class="token plain"> textWidth</span><span class="token operator" style="color:#e09142">/</span><span class="token number" style="color:#e09142">2</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> h</span><span class="token operator" style="color:#e09142">/</span><span class="token number" style="color:#e09142">2</span><span class="token operator" style="color:#e09142">-</span><span class="token plain">textSize</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> textWidth</span><span class="token operator" style="color:#e09142">*</span><span class="token number" style="color:#e09142">1.2</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> textSize</span><span class="token operator" style="color:#e09142">*</span><span class="token number" style="color:#e09142">1.5</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// Fill the context (and text) with selected color</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">         ctx</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">fillStyle</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> color</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token comment" style="color:#6c6783">// Draw the text using the fillText() method</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">         ctx</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">fillText</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">wmText</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> w</span><span class="token operator" style="color:#e09142">/</span><span class="token number" style="color:#e09142">2</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">-</span><span class="token plain"> textWidth</span><span class="token operator" style="color:#e09142">/</span><span class="token number" style="color:#e09142">2.3</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> h</span><span class="token operator" style="color:#e09142">/</span><span class="token number" style="color:#e09142">2</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#ffcc99">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">position </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token string" style="color:#ffcc99">&quot;bottom-left&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        ctx</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">fillStyle</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> bgColor</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        ctx</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">fillRect</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">w </span><span class="token operator" style="color:#e09142">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">w </span><span class="token operator" style="color:#e09142">-</span><span class="token plain"> </span><span class="token number" style="color:#e09142">2</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> h </span><span class="token operator" style="color:#e09142">-</span><span class="token plain"> textSize</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> textWidth</span><span class="token operator" style="color:#e09142">*</span><span class="token number" style="color:#e09142">1.2</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> textSize</span><span class="token operator" style="color:#e09142">*</span><span class="token number" style="color:#e09142">1.5</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// Fill context (and text) with selected color</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        ctx</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">fillStyle</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> color</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        ctx</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">fillText</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">wmText</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> w </span><span class="token operator" style="color:#e09142">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">w </span><span class="token operator" style="color:#e09142">-</span><span class="token plain"> </span><span class="token number" style="color:#e09142">10</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> h </span><span class="token operator" style="color:#e09142">-</span><span class="token plain"> </span><span class="token number" style="color:#e09142">10</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span></div></pre>
<p>With the above code, we&#x27;re pretty much done. You can select an image, type some text into the interface, select colors and fonts. When you click &quot;preview&quot;, the text will be drawn on the image using the selected properties.</p>
<p><img src="/watermarked-image.png" alt=""/></p>
<p>Note that the <code>selectedIndex</code> property returns the index of the option currently selected in a dropdown. The list of options is converted to an array, and each element can be selected from the array using the index (0-indexed).</p>
<p>The <code>fillText()</code> method accepts the text to draw on the canvas along with its x and y positions. There are various methods for setting the text font, size, and more. Just like with rectangles, we can set text stroke and fill using <code>fillText()</code> and <code>strokeText()</code> respectively. Both methods take four arguments: the text to draw, the x position, y position, and optionally, the max-width (forces the text to scale if it&#x27;s wider than the provided max-width).</p>
<p>The font of a piece of text is controlled via the context using <code>font</code> property. This property is set using the same format as in CSS. If we specify every property value, we&#x27;ll set (in this order): font style, font weight, font size, and font family. For example:</p>
<pre class="prism-code language-js" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> canvas </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#ffcc99">document</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">getElementById</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;canvas&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> ctx </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> canvas</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">getContext</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;2d&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">ctx</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">font</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token string" style="color:#ffcc99">&quot;3em monospace&quot;</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">ctx</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">fillText</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;Hello, how are you?&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token number" style="color:#e09142">100</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token number" style="color:#e09142">50</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">ctx</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">font</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token string" style="color:#ffcc99">&quot;italic bold 2em serif&quot;</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">ctx</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">fillText</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;Hola, ¬øc√≥mo est√°s?&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token number" style="color:#e09142">100</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token number" style="color:#e09142">100</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span></div></pre>
<p>The above code produces the following results:</p>
<p><img src="/font-test.png" alt=""/></p>
<p>The canvas does not have a direct way of creating text with a background. An easy workaround is to draw a rectangle and place it below the text, making it look like a background.</p>
<p>Let&#x27;s take a closer look at <code>fillStyle</code>. It is a context property that holds the color of anything drawn on the canvas. It accepts color names (like red, black. green) and values like <code>#0000</code> or <code>rgb(0,0,0)</code>.</p>
<pre class="prism-code language-js" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token plain">ctx</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">fillStyle</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> color</span><span class="token punctuation" style="color:#6c6783">;</span></div></pre>
<p>Notice that since the text background and text color are usually different values, we have to set <code>fillStyle</code> multiple times. You might expect us to set the rectangle color and text color using the <code>fillRect()</code> and <code>fillText()</code> methods respectively, but that is not how the canvas works.</p>
<p>The canvas context is an object that maintains a state. With <code>fillStyle</code>, we update this state, telling the canvas that any subsequent shapes should use this color. This color persists until <code>fillStyle</code> is updated again.</p>
<h3>Downloading an image from the canvas</h3>
<p>If you want to go further, you can <a href="/blog/download-canvas-image">add download functionality</a> so that the watermarked image can be downloaded and saved to the user&#x27;s device. This can be done using the <code>toDataURL()</code> method of the canvas object.</p>
<h2>Summary</h2>
<p>Here are the canvas basics we covered in this tutorial:</p>
<ul>
<li>The canvas is an element that provides a drawing space on a web page</li>
<li>You specify the width and height of the canvas using the width and height attributes on the element</li>
<li>Everything drawn on the canvas is done using JavaScript</li>
<li>Before you can draw on the canvas, you must first create a context that provides a kind of interface (e.g 2D).</li>
<li>To create a rectangle, use the context <code>fillRect()</code> method. This draws a rectangle filled with color.</li>
<li>To create a rectangle outline, use <code>strokeRect()</code> method</li>
<li>to draw text in the canvas, use the <code>fillText()</code> method. You can specify the position, color, style, and other text properties using context properties.</li>
<li>When you set a context property, such as <code>fillStyle</code>, it applied to every drawing that follows until you change the property to a different value.</li>
<li>To draw an image on the canvas, use the <code>drawImage()</code> method.</li>
</ul></div><hr/><nav class="post-navigation" aria-label="Post navigation"><h3> Read other posts</h3><ul><li><a href="/blog/ux-writing-tips">‚Üê <!-- -->9 UX writing tips for designers and developers</a></li><li><a href="/blog/download-canvas-image">How to download an HTML5 canvas as an image using JavaScript<!-- --> ‚Üí</a></li></ul></nav></article></main><div><footer><span><div class="copyright"><span>¬©</span> <!-- -->2025<!-- --> Enjeck. All Rights Reserved.</div></span></footer></div></div><!--$--><!--/$--><script src="/_next/static/chunks/5fcaeda216ddf010.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[48249,[\"/_next/static/chunks/b42444546cf1924e.js\",\"/_next/static/chunks/8578e6e2b7d87452.js\"],\"default\"]\n3:I[23288,[\"/_next/static/chunks/b42444546cf1924e.js\",\"/_next/static/chunks/8578e6e2b7d87452.js\"],\"default\"]\n4:I[37667,[\"/_next/static/chunks/0b32bff5a2dff718.js\"],\"\"]\n6:I[27271,[\"/_next/static/chunks/b42444546cf1924e.js\",\"/_next/static/chunks/8578e6e2b7d87452.js\"],\"OutletBoundary\"]\n7:\"$Sreact.suspense\"\n9:I[27271,[\"/_next/static/chunks/b42444546cf1924e.js\",\"/_next/static/chunks/8578e6e2b7d87452.js\"],\"ViewportBoundary\"]\nb:I[27271,[\"/_next/static/chunks/b42444546cf1924e.js\",\"/_next/static/chunks/8578e6e2b7d87452.js\"],\"MetadataBoundary\"]\nd:I[30556,[],\"default\"]\n:HL[\"/_next/static/chunks/e5da751912c10467.css\",\"style\"]\n:HL[\"/_next/static/chunks/e2fae31b48403321.css\",\"style\"]\n:HL[\"/_next/static/chunks/69ef5a39cc4d8dfb.css\",\"style\"]\n:HL[\"https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"J4CUv_BJLZ-ivLom0QHcs\",\"c\":[\"\",\"blog\",\"html5-canvas-watermark\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"html5-canvas-watermark\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/e5da751912c10467.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/e2fae31b48403321.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/0b32bff5a2dff718.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css\"}],[\"$\",\"script\",null,{\"type\":\"application/ld+json\",\"dangerouslySetInnerHTML\":{\"__html\":\"{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@type\\\":\\\"WebSite\\\",\\\"name\\\":\\\"Enjeck's Portfolio\\\",\\\"url\\\":\\\"https://enjeck.github.io\\\",\\\"author\\\":{\\\"@type\\\":\\\"Person\\\",\\\"name\\\":\\\"Enjeck\\\"}}\"}}]]}],[\"$\",\"body\",null,{\"children\":[[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}],[[\"$\",\"$L4\",null,{\"strategy\":\"afterInteractive\",\"src\":\"https://www.googletagmanager.com/gtag/js?id=G-W8GSQN5XSZ\"}],[\"$\",\"$L4\",null,{\"id\":\"google-analytics\",\"strategy\":\"afterInteractive\",\"children\":\"\\n          window.dataLayer = window.dataLayer || [];\\n          function gtag(){dataLayer.push(arguments);}\\n          gtag('js', new Date());\\n          gtag('config', 'G-W8GSQN5XSZ');\\n        \"}]]]}]]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/69ef5a39cc4d8dfb.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/cbec149b17a636bf.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-1\",{\"src\":\"/_next/static/chunks/ad06993566a63284.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@8\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L9\",null,{\"children\":\"$@a\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.Metadata\",\"children\":\"$@c\"}]}]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$d\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"e:I[36427,[\"/_next/static/chunks/0b32bff5a2dff718.js\",\"/_next/static/chunks/cbec149b17a636bf.js\",\"/_next/static/chunks/ad06993566a63284.js\"],\"default\"]\nf:I[73235,[\"/_next/static/chunks/0b32bff5a2dff718.js\",\"/_next/static/chunks/cbec149b17a636bf.js\",\"/_next/static/chunks/ad06993566a63284.js\"],\"default\"]\n10:I[47038,[\"/_next/static/chunks/0b32bff5a2dff718.js\",\"/_next/static/chunks/cbec149b17a636bf.js\",\"/_next/static/chunks/ad06993566a63284.js\"],\"\"]\n11:I[98374,[\"/_next/static/chunks/0b32bff5a2dff718.js\",\"/_next/static/chunks/cbec149b17a636bf.js\",\"/_next/static/chunks/ad06993566a63284.js\"],\"default\"]\n"])</script><script>self.__next_f.push([1,"5:[[\"$\",\"$Le\",null,{}],[\"$\",\"$Lf\",null,{\"children\":[[\"$\",\"script\",null,{\"type\":\"application/ld+json\",\"dangerouslySetInnerHTML\":{\"__html\":\"{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@type\\\":\\\"BlogPosting\\\",\\\"headline\\\":\\\"Learn HTML5 canvas by building an image watermarking tool\\\",\\\"datePublished\\\":\\\"2022-03-15\\\",\\\"author\\\":{\\\"@type\\\":\\\"Person\\\",\\\"name\\\":\\\"Enjeck\\\"},\\\"publisher\\\":{\\\"@type\\\":\\\"Person\\\",\\\"name\\\":\\\"Enjeck\\\"}}\"}}],[\"$\",\"article\",null,{\"className\":\"blogpost-content\",\"children\":[[\"$\",\"div\",null,{\"className\":\"centered\",\"children\":[[\"$\",\"$L10\",null,{\"href\":\"/blog\",\"style\":{\"borderBottom\":\"2px dotted var(--dark-black)\",\"padding\":\"10px 20px\"},\"children\":\"‚Üê Back to blog\"}],[\"$\",\"h1\",null,{\"className\":\"blogpost-title\",\"children\":[\"$\",\"span\",null,{\"children\":\"Learn HTML5 canvas by building an image watermarking tool\"}]}],[\"$\",\"div\",null,{\"className\":\"post-meta\",\"children\":[[\"$\",\"time\",null,{\"className\":\"date\",\"dateTime\":\"2022-03-15\",\"children\":\"2022-03-15\"}],[\"$\",\"span\",null,{\"className\":\"reading-time\",\"children\":[14,\" min read\"]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"blog-body\",\"children\":[[\"$\",\"p\",null,{\"children\":\"HTML5 canvas allows us to create and manipulate pixels, just like a painter working on a canvas. We can draw text and graphics onto the canvas using JavaScript. To demonstrate its power, let's build an image watermarking tool that allows a user to upload an image and watermark it with text.\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Adding the canvas into a web page\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Before you begin, create a file called \",[\"$\",\"code\",null,{\"children\":\"index.html\"}],\". Here, we will write most of our code.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The HTML5 canvas can be added to a page just like any other element. It starts with an opening \",[\"$\",\"code\",null,{\"children\":\"\u003ccanvas\u003e\"}],\" tag and closes with \",[\"$\",\"code\",null,{\"children\":\"\u003c/canvas\u003e\"}],\". Like other HTML elements, it can take attributes like \",[\"$\",\"code\",null,{\"children\":\"id\"}],\" for identification, \",[\"$\",\"code\",null,{\"children\":\"width\"}],\" to define the horizontal length in pixels, and \",[\"$\",\"code\",null,{\"children\":\"height\"}],\" to define the vertical area of the page it occupies.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The canvas in the following code is 600 pixels wide and 600 pixels high.\"}],\"\\n\",[\"$\",\"$L11\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-html\",\"children\":\"\u003c!doctype html\u003e\\n\u003chtml lang=\\\"en\\\"\u003e\\n    \u003chead\u003e\\n        \u003ctitle\u003eWatermark\u003c/title\u003e\\n        \u003cmeta charset=\\\"utf-8\\\"\u003e\\n    \u003c/head\u003e\\n    \u003cbody\u003e\\n        \u003ccanvas id=\\\"canvas\\\" width=\\\"600\\\" height=\\\"600\\\"\u003e\u003c/canvas\u003e\\n    \u003c/body\u003e\\n    \u003cstyle\u003e\\n        canvas {\\n            border: 1px solid #000;\\n        }\\n    \u003c/style\u003e\\n    \u003cscript\u003e\\n    \u003c/script\u003e\\n\u003c/html\u003e\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Go ahead and save the code as an HTML file and load it into a browser.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"To see our canvas, we have given it a tiny black border, defined within the \",[\"$\",\"code\",null,{\"children\":\"style\"}],\" tags. Without this border, a blank white page is shown and we won't know exactly where the canvas is. For now, we'll write JavaScript code between the \",[\"$\",\"code\",null,{\"children\":\"script\"}],\" tags.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"A page can have as many canvas elements as we like. Since the canvas is transparent, it can be placed on top of other elements. This allows us to draw on top of an image or something else.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Notice that we set the width and height of the canvas as an inline style on the element itself, and not as CSS styles within the \",[\"$\",\"code\",null,{\"children\":\"\u003cstyle\u003e\"}],\" tag. That's because the \",[\"$\",\"code\",null,{\"children\":\"height\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"width\"}],\" attributes work differently with the canvas, compared to other elements. The default dimension of the canvas is 300px by 150px -- it takes these values when the height and width HTML attributes are not explicitly set. If you later set the dimensions in CSS, say 600px by 600px, the canvas scales from its default size of 300 by 150 to fit this size, and everything drawn in the canvas scales with it. This might cause some pixelation issues (pixels get stretched and appear chunky), similar to what occurs when you resize a raster image. By making the canvas bigger (or smaller, if you prefer), anything drawn in it will be scaled to fit the specified dimensions.\"]}],\"\\n\",\"$L12\",\"\\n\",\"$L13\",\"\\n\",\"$L14\",\"\\n\",\"$L15\",\"\\n\",\"$L16\",\"\\n\",\"$L17\",\"\\n\",\"$L18\",\"\\n\",\"$L19\",\"\\n\",\"$L1a\",\"\\n\",\"$L1b\",\"\\n\",\"$L1c\",\"\\n\",\"$L1d\",\"\\n\",\"$L1e\",\"\\n\",\"$L1f\",\"\\n\",\"$L20\",\"\\n\",\"$L21\",\"\\n\",\"$L22\",\"\\n\",\"$L23\",\"\\n\",\"$L24\",\"\\n\",\"$L25\",\"\\n\",\"$L26\",\"\\n\",\"$L27\",\"\\n\",\"$L28\",\"\\n\",\"$L29\",\"\\n\",\"$L2a\",\"\\n\",\"$L2b\",\"\\n\",\"$L2c\",\"\\n\",\"$L2d\",\"\\n\",\"$L2e\",\"\\n\",\"$L2f\",\"\\n\",\"$L30\",\"\\n\",\"$L31\",\"\\n\",\"$L32\",\"\\n\",\"$L33\",\"\\n\",\"$L34\",\"\\n\",\"$L35\",\"\\n\",\"$L36\",\"\\n\",\"$L37\",\"\\n\",\"$L38\",\"\\n\",\"$L39\",\"\\n\",\"$L3a\",\"\\n\",\"$L3b\",\"\\n\",\"$L3c\",\"\\n\",\"$L3d\",\"\\n\",\"$L3e\",\"\\n\",\"$L3f\",\"\\n\",\"$L40\",\"\\n\",\"$L41\",\"\\n\",\"$L42\",\"\\n\",\"$L43\",\"\\n\",\"$L44\",\"\\n\",\"$L45\",\"\\n\",\"$L46\",\"\\n\",\"$L47\",\"\\n\",\"$L48\",\"\\n\",\"$L49\",\"\\n\",\"$L4a\"]}],\"$L4b\",\"$L4c\"]}]]}]]\n"])</script><script>self.__next_f.push([1,":HL[\"/filled-rect.png\",\"image\"]\n:HL[\"/watermark-interface.png\",\"image\"]\n:HL[\"/load-image-watermark.png\",\"image\"]\n:HL[\"/watermarked-image.png\",\"image\"]\n:HL[\"/font-test.png\",\"image\"]\n12:[\"$\",\"h2\",null,{\"children\":\"Drawing on the canvas\"}]\n13:[\"$\",\"p\",null,{\"children\":\"Let's begin writing some JavaScript between our script tags:\"}]\n14:[\"$\",\"$L11\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-js\",\"children\":\"// Start drawing after the page is fully loaded. \\n     window.onload = function(){\\n     // Get the canvas element, where we shall draw the background elements. \\n       const canvas = document.getElementById(\\\"canvas\\\");\\n       // To draw, we need to select a context for the canvas, 2d in this case, since we're drawing 2d items. \\n        const context = canvas.getContext(\\\"2d\\\");\\n     }\\n\\n\"}]}]\n15:[\"$\",\"p\",null,{\"children\":\"In the code above, we get the canvas element we created. Before we can draw, we must set an interface by getting a context. The context defines the properties and methods used to draw on the canvas. Here, we use a 2D context.\"}]\n16:[\"$\",\"p\",null,{\"children\":\"Using JavaScript to check for canvas support might be a bit of an overkill, depending on what you are trying to do. JavaScript's power comes into play when you want to provide users with a different experience (such as displaying another content or redirecting to another page) when there's no canvas support.\"}]\n17:[\"$\",\"p\",null,{\"children\":\"If you intend to just display some backup text when the canvas is not supported, it suffices to just use plain HTML.\"}]\n18:[\"$\",\"p\",null,{\"children\":\"When a supported element (such as text or image) is placed within the canvas element, it will be displayed if the canvas is not supported. By default, whenever a browser sees an element it does not recognize, it displays any text within the element.\"}]\n19:[\"$\",\"$L11\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-html\",\"children\":\"\u003ccanvas id=\\\"canvas\\\"\u003e\\nNo canvas support. Please upgrade. \\n\u003c/canvas\u003e\\n\"}]}]\n1a:[\"$\",\"p\",null,{\"children\":\"With the code above, browsers without canvas support will display the text \\\"No canvas support. Please upgrade\\\", whereas, capable browsers ignore any text within the canvas tags and instead shows drawings generated via JavaScript.\"}]\n1b:[\"$\",\"h2\",null,{\"children\":\"Drawing a basic shape\"}]\n1c:[\"$\",\"p\",null,{\"children\":[\"Before we jump into the main watermarking application, let's test the canvas by drawing a simple shape.\\nTo draw a rectangle, we use the \",[\"$\",\"code\",null,{\"children\":\"fillRect()\"}],\" method. It takes 4 arguments, corresponding to the \",[\"$\",\"em\",null,{\"children\":\"x position\"}],\", \",[\"$\",\"em\",null,{\"children\":\"y position\"}],\", \",[\"$\",\"em\",null,{\"children\":\"width\"}],\", and \",[\"$\",\"em\",null,{\"children\":\"height\"}],\".\"]}]\n1d:[\"$\",\"$L11\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-js\",\"children\":\"\u003cscript\u003e\\n     window.onload = function(){\\n       const canvas = document.getElementById(\\\"canvas\\\");\\n        let context = canvas.getContext(\\\"2d\\\");\\n         context.fillRect(0, 0, 100, 100)\\n     }\\n\u003c/script\u003e\\n\"}]}]\n1e:[\"$\",\"p\",null,{\"children\":[\"The code \",[\"$\",\"code\",null,{\"children\":\"context.fillRect(0, 0, 100, 100)\"}],\" creates a rectangle starting from the top left, with dimensions 100 x 100 pixels. This rectangle is colored black, which is the default fill color for the canvas.\"]}]\n1f:[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/filled-rect.png\",\"alt\":\"\"}]}]\n20:[\"$\",\"p\",null,{\"children\":[\"To draw a rectangle with a stroke rather than fill, we would use the \",[\"$\",\"code\",null,{\"children\":\"strokeRect()\"}],\" method rather than \",[\"$\",\"code\",null,{\"children\":\"fillRect()\"}],\". If you now load \",[\"$\",\"code\",null,{\"children\":\"index.html\"}],\" in your browser, you should see something like this:\"]}]\n21:[\"$\",\"p\",null,{\"children\":[\"Great, our canvas is up and running. We have tested it out, and it works. Go ahead and delete the \",[\"$\",\"code\",null,{\"children\":\"context.fillRect(0, 0, 100, 100)\"}],\" code. We don't need it anymore.\"]}]\n22:[\"$\",\"h2\",null,{\"children\":\"Building the app in"])</script><script>self.__next_f.push([1,"terface\"}]\n23:[\"$\",\"p\",null,{\"children\":\"Before we begin implementing the watermarking app, let's consider its interface and features:\"}]\n24:[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"There is a canvas element, along with form elements that act as the user interface.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"The form will have input fields like a \\\"browse\\\" button to upload an image, a text input to enter the watermark text, select fields for choosing the text color, text size, text background, the position of text on the image, and a preview button.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"We'll grab user input from the form and use it to draw on the canvas using JavaScript.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"The preview button will prompt JavaScript to retrieve user input and print data on canvas.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Optionally, we can add a download button for saving the finished watermarked image.\"}],\"\\n\"]}]\n25:[\"$\",\"p\",null,{\"children\":\"To begin with, here's the HTML code:\"}]\n26:[\"$\",\"$L11\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-html\",\"children\":\"\u003c!doctype html\u003e\\n\u003chtml lang=\\\"en\\\"\u003e\\n    \u003chead\u003e\\n        \u003ctitle\u003eWatermark\u003c/title\u003e\\n        \u003cmeta charset=\\\"utf-8\\\" /\u003e\\n        \u003cstyle\u003e\\n            canvas {\\n              border: 1px solid black;\\n              }\\n        \u003c/style\u003e\\n    \u003c/head\u003e\\n    \u003cbody\u003e\\n       \u003ch1\u003e Watermarker \u003c/h1\u003e\\n        \u003ccanvas id=\\\"canvas\\\" width=\\\"600\\\" height=\\\"400\\\"\u003e\\n          \u003cp\u003e No canvas support. Please upgrade your browser. \u003c/p\u003e\\n        \u003c/canvas\u003e\\n        \u003cform\u003e\\n            \u003c/form\u003e\\n\\n            \u003cscript src=\\\"watermark.js\\\"\u003e\u003c/script\u003e\\n    \u003c/body\u003e\\n\u003c/html\u003e\\n\"}]}]\n27:[\"$\",\"p\",null,{\"children\":[\"We have moved our script code to a \",[\"$\",\"code\",null,{\"children\":\"watermark.js\"}],\" file and linked it to it within the \",[\"$\",\"code\",null,{\"children\":\"\u003chead\u003e\"}],\". The canvas still has the fallback text for old browsers that do not support the canvas API.\"]}]\n28:[\"$\",\"p\",null,{\"children\":[\"Also, there is a \",[\"$\",\"code\",null,{\"children\":\"\u003cform\u003e\"}],\" element containing controls that support the watermarking features.\"]}]\n29:[\"$\",\"p\",null,{\"children\":[\"Let's add the \",[\"$\",\"code\",null,{\"children\":\"\u003cform\u003e\"}],\" data. This form serves as the user interface.\"]}]\n4d:T85d,"])</script><script>self.__next_f.push([1,"    \u003cform\u003e\n      \u003c!-- Where the user selects an image --\u003e\n      \u003cp\u003e\n        \u003clabel for=\"imageLoader\" id=\"imageLoaderLabel\"\u003eChoose an image:\u003c/label\u003e\u003cbr /\u003e\n        \u003cinput type=\"file\" id=\"imageLoader\" name=\"imageLoader\" /\u003e\n      \u003c/p\u003e\n\n      \u003c!-- Where the user enters the text to be used as a watermark --\u003e\n      \u003cp\u003e\n        \u003clabel for=\"watermarkText\"\u003eEnter the text to use:\u003c/label\u003e\u003cbr /\u003e\n        \u003cinput type=\"text\" id=\"watermarkText\" name=\"watermarkText\" /\u003e\n      \u003c/p\u003e\n\n      \u003c!-- Where the user  selects the position of the text on the image. Feel free to add more options--\u003e\n      \u003cp\u003e\n        \u003clabel for=\"textPosition\"\u003ePosition of text:\u003c/label\u003e\u003cbr /\u003e\n        \u003cselect id=\"textPosition\"\u003e\n          \u003coption value=\"bottom-left\"\u003eBottom Left\u003c/option\u003e\n          \u003coption value=\"center\"\u003e Center \u003c/option\u003e\n        \u003c/select\u003e\n      \u003c/p\u003e\n\n      \u003c!-- Where the user  selects the color of the text on the image. Feel free to add more options--\u003e\n      \u003cp\u003e\n        \u003clabel for=\"textColor\"\u003eColor of text:\u003c/label\u003e\u003cbr /\u003e\n        \u003cselect id=\"textColor\"\u003e\n          \u003coption value=\"black\"\u003eblack\u003c/option\u003e\n          \u003coption value=\"blue\"\u003eblue\u003c/option\u003e\n          \u003coption value=\"red\"\u003ered\u003c/option\u003e\n        \u003c/select\u003e\n      \u003c/p\u003e\n\n      \u003c!-- Another selection control for choosing the font of the text. Feel free to add more options--\u003e\n      \u003cp\u003e\n        \u003clabel for=\"textFont\"\u003eText font:\u003c/label\u003e\u003cbr /\u003e\n        \u003cselect id=\"textFont\"\u003e\n          \u003coption value=\"arial\"\u003eArial\u003c/option\u003e\n          \u003coption value=\"helvetica\"\u003eHelvetica\u003c/option\u003e\n          \u003coption value=\"monospace\"\u003eMonospace\u003c/option\u003e\n        \u003c/select\u003e\n      \u003c/p\u003e\n\n      \u003c!-- Another selection control for choosing the color of the text background. Feel free to add more options--\u003e\n      \u003cp\u003e\n        \u003clabel for=\"textBgColor\"\u003eText background color:\u003c/label\u003e\u003cbr /\u003e\n        \u003cselect id=\"textBgColor\"\u003e\n          \u003coption value=\"black\"\u003eblack\u003c/option\u003e\n          \u003coption value=\"white\"\u003ewhite\u003c/option\u003e\n          \u003coption value=\"transparent\"\u003etransparent\u003c/option\u003e\n        \u003c/select\u003e\n      \u003c/p\u003e\n\n      \u003c!-- Buttons to preview or download the watermarked image --\u003e\n\n      \u003cinput type=\"button\" id=\"previewBtn\" value=\"Preview\"\u003e\n\n    \u003c/form\u003e\n"])</script><script>self.__next_f.push([1,"2a:[\"$\",\"$L11\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-html\",\"children\":\"$4d\"}]}]\n2b:[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/watermark-interface.png\",\"alt\":\"\"}]}]\n2c:[\"$\",\"p\",null,{\"children\":\"We've dealt with the markup. Now, we can handle the script.\"}]\n2d:[\"$\",\"p\",null,{\"children\":[\"Let's start by writing code to load a selected image to the canvas when the \\\"browse...\\\" (\",[\"$\",\"code\",null,{\"children\":\"id = imageLoader\"}],\") button is clicked.\"]}]\n2e:[\"$\",\"p\",null,{\"children\":[\"Add the following code into \",[\"$\",\"code\",null,{\"children\":\"watermark.js\"}],\":\"]}]\n2f:[\"$\",\"$L11\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-js\",\"children\":\"// Select the \\\"browse\\\" button, used to choose the image\\nconst imageLoader = document.getElementById('imageLoader');\\n\\n/* When the user selects an image, call the loadImage function */\\n    imageLoader.addEventListener('change', loadImage, false);\\n\\n// Select the canvas and give it a 2d context \\nconst canvas = document.getElementById('canvas');\\nconst ctx = canvas.getContext('2d');\\n\\n\"}]}]\n30:[\"$\",\"p\",null,{\"children\":[\"The event listener calls the \",[\"$\",\"code\",null,{\"children\":\"loadImage()\"}],\" function, which is defined below. It reads the selected image using the \",[\"$\",\"code\",null,{\"children\":\"FileReader\"}],\" object and draws it onto the canvas using \",[\"$\",\"code\",null,{\"children\":\"drawImage()\"}],\".\"]}]\n31:[\"$\",\"$L11\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-js\",\"children\":\"function loadImage(e){\\n    // Read the selected image \\n    const reader = new FileReader();\\n    reader.onload = function(event){\\n        const img = new Image();\\n        img.onload = function(){\\n            /* Set the width and height of the canvas to\\n             match the size of the chosen image */\\n            canvas.width = img.width;\\n            canvas.height = img.height;\\n            // Draw the image on the canvas\\n            ctx.drawImage(img,0,0);\\n        }\\n        img.src = event.target.result;\\n        /* Delete the image loader with the prompt to \\\"Choose an image\\\" after an image is chosen */\\n        document.getElementById('imageLoaderLabel').remove();\\n    }\\n    reader.readAsDataURL(e.target.files[0]);     \\n}\\n\"}]}]\n32:[\"$\",\"p\",null,{\"children\":[\"If you visit \",[\"$\",\"code\",null,{\"children\":\"index.html\"}],\" in a browser, you should be able to select an image and it will be loaded to the canvas.\"]}]\n33:[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/load-image-watermark.png\",\"alt\":\"\"}]}]\n34:[\"$\",\"p\",null,{\"children\":[\"Next, let's enable the \\\"preview\\\" (\",[\"$\",\"code\",null,{\"children\":\"id=\\\"previewBtn\\\"\"}],\") button by making it call a JavaScript function when it is clicked.\"]}]\n35:[\"$\",\"$L11\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-js\",\"children\":\"window.onload = function() {\\n    // Get the preview button element\\n    const button = document.getElementById(\\\"previewBtn\\\");\\n    /* Add a click handler to the button so that\\n    the previewImage function is called when clicked */\\n    button.onclick = previewImage;\\n    };\\n\"}]}]\n36:[\"$\",\"p\",null,{\"children\":[\"Now, when the preview button is clicked, the \",[\"$\",\"code\",null,{\"children\":\"previewImage()\"}],\" function is called. Within this function, we shall later add code to watermark the image loaded into the canvas.\"]}]\n37:[\"$\",\"p\",null,{\"children\":[\"Let's start writing the \",[\"$\",\"code\",null,{\"children\":\"previewImage()\"}],\" function. For the most part, we will use the \",[\"$\",\"code\",null,{\"children\":\"fillText()\"}],\" method. It takes four arguments, corresponding to the actual text, x position, y position, and optionally, the maximum width of the text). It fills the provided text at the (x, y) position of the canvas. The code \",[\"$\",\"code\",null,{\"children\":\"context.fillText(\\\"hello\\\", 100, 100)\"}],\" creates a text \\\"hello\\\" starting 100 pixels from the left and top.\"]}]\n4e:T9da,"])</script><script>self.__next_f.push([1,"function previewImage() {\n  // Select the canvas and give it a 2d context\n  let canvas = document.getElementById(\"canvas\");\n  let ctx = canvas.getContext(\"2d\");\n\n  /* Get the value of element with an id of \"watermarkText\" */\n  let wmText = document.getElementById(\"watermarkText\").value;\n\n  /* If there's actually some text*/\n  if(wmText) {\n\n    /* Find out what options the user has chosen by \n    getting the indices of the selected items */\n\n    // Get the selected text position \n    let selectPos = document.getElementById(\"textPosition\");\n    let posIndex = selectPos.selectedIndex;\n    let position = selectPos[posIndex].value;\n\n    // Get the selected text color\n    let selectCol = document.getElementById(\"textColor\");\n    let colIndex = selectCol.selectedIndex;\n    let color = selectCol[colIndex].value;\n\n    // Get the selected text color \n    let selectFont = document.getElementById(\"textFont\");\n    let fontIndex = selectFont.selectedIndex;\n    let font = selectFont[fontIndex].value;\n\n    // Give text a size of 40px and assign it to the selected font\n    let textSize = 40\n    ctx.font = `${textSize}px ${font}`;\n\n    // Get the width and height of the canvas\n    let w = canvas.width;\n    let h = canvas.height;\n\n    // Get width of the text\n    let text = ctx.measureText(wmText);\n    let textWidth = text.width;\n\n    // Get the selected text background color \n    let selectBgColor = document.getElementById(\"textBgColor\");\n    let bgIndex = selectBgColor.selectedIndex;\n    let bgColor = selectBgColor[bgIndex].value;\n\n    /* Position the text on the image based on the selected position */\n    if (position == \"center\") {\n\n        // Color the background with the selected color using the fillStyle property\n        ctx.fillStyle = bgColor;\n        /* Draw the background using the fillStyle property. The x, y positions, width\n        and height are based on the width of the text */\n        ctx.fillRect(w/2 - textWidth/2, h/2-textSize, textWidth*1.2, textSize*1.5);\n        \n        // Fill the context (and text) with selected color\n         ctx.fillStyle = color;\n         // Draw the text using the fillText() method\n         ctx.fillText(wmText, w/2 - textWidth/2.3, h/2);\n    }\n\n    else if (position == \"bottom-left\") {\n        \n        ctx.fillStyle = bgColor;\n        ctx.fillRect(w - (w - 2), h - textSize, textWidth*1.2, textSize*1.5);\n        // Fill context (and text) with selected color\n        ctx.fillStyle = color;\n        ctx.fillText(wmText, w - (w - 10), h - 10);\n    }\n  }\n}\n"])</script><script>self.__next_f.push([1,"38:[\"$\",\"$L11\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-js\",\"children\":\"$4e\"}]}]\n39:[\"$\",\"p\",null,{\"children\":\"With the above code, we're pretty much done. You can select an image, type some text into the interface, select colors and fonts. When you click \\\"preview\\\", the text will be drawn on the image using the selected properties.\"}]\n3a:[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/watermarked-image.png\",\"alt\":\"\"}]}]\n3b:[\"$\",\"p\",null,{\"children\":[\"Note that the \",[\"$\",\"code\",null,{\"children\":\"selectedIndex\"}],\" property returns the index of the option currently selected in a dropdown. The list of options is converted to an array, and each element can be selected from the array using the index (0-indexed).\"]}]\n3c:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"fillText()\"}],\" method accepts the text to draw on the canvas along with its x and y positions. There are various methods for setting the text font, size, and more. Just like with rectangles, we can set text stroke and fill using \",[\"$\",\"code\",null,{\"children\":\"fillText()\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"strokeText()\"}],\" respectively. Both methods take four arguments: the text to draw, the x position, y position, and optionally, the max-width (forces the text to scale if it's wider than the provided max-width).\"]}]\n3d:[\"$\",\"p\",null,{\"children\":[\"The font of a piece of text is controlled via the context using \",[\"$\",\"code\",null,{\"children\":\"font\"}],\" property. This property is set using the same format as in CSS. If we specify every property value, we'll set (in this order): font style, font weight, font size, and font family. For example:\"]}]\n3e:[\"$\",\"$L11\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-js\",\"children\":\"let canvas = document.getElementById(\\\"canvas\\\");\\nlet ctx = canvas.getContext(\\\"2d\\\");\\nctx.font = \\\"3em monospace\\\";\\nctx.fillText(\\\"Hello, how are you?\\\", 100, 50);\\nctx.font = \\\"italic bold 2em serif\\\";\\nctx.fillText(\\\"Hola, ¬øc√≥mo est√°s?\\\", 100, 100);\\n\"}]}]\n3f:[\"$\",\"p\",null,{\"children\":\"The above code produces the following results:\"}]\n40:[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/font-test.png\",\"alt\":\"\"}]}]\n41:[\"$\",\"p\",null,{\"children\":\"The canvas does not have a direct way of creating text with a background. An easy workaround is to draw a rectangle and place it below the text, making it look like a background.\"}]\n42:[\"$\",\"p\",null,{\"children\":[\"Let's take a closer look at \",[\"$\",\"code\",null,{\"children\":\"fillStyle\"}],\". It is a context property that holds the color of anything drawn on the canvas. It accepts color names (like red, black. green) and values like \",[\"$\",\"code\",null,{\"children\":\"#0000\"}],\" or \",[\"$\",\"code\",null,{\"children\":\"rgb(0,0,0)\"}],\".\"]}]\n43:[\"$\",\"$L11\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-js\",\"children\":\"ctx.fillStyle = color;\\n\"}]}]\n44:[\"$\",\"p\",null,{\"children\":[\"Notice that since the text background and text color are usually different values, we have to set \",[\"$\",\"code\",null,{\"children\":\"fillStyle\"}],\" multiple times. You might expect us to set the rectangle color and text color using the \",[\"$\",\"code\",null,{\"children\":\"fillRect()\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"fillText()\"}],\" methods respectively, but that is not how the canvas works.\"]}]\n45:[\"$\",\"p\",null,{\"children\":[\"The canvas context is an object that maintains a state. With \",[\"$\",\"code\",null,{\"children\":\"fillStyle\"}],\", we update this state, telling the canvas that any subsequent shapes should use this color. This color persists until \",[\"$\",\"code\",null,{\"children\":\"fillStyle\"}],\" is updated again.\"]}]\n46:[\"$\",\"h3\",null,{\"children\":\"Downloading an image from the canvas\"}]\n47:[\"$\",\"p\",null,{\"children\":[\"If you want to go further, you can \",[\"$\",\"a\",null,{\"href\":\"/blog/download-canvas-image\",\"children\":\"add download functionality\"}],\" so that the watermarked image can be downloaded and saved to the user's device. This can be done using the \",[\"$\",\"code\",null,{\"children\":\"toDataURL()\"}],\" method of the canvas object.\"]}]\n48:[\"$\",\"h2\",null,{\"children\":\"Summary\"}]\n49:[\"$\""])</script><script>self.__next_f.push([1,",\"p\",null,{\"children\":\"Here are the canvas basics we covered in this tutorial:\"}]\n"])</script><script>self.__next_f.push([1,"4a:[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"The canvas is an element that provides a drawing space on a web page\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"You specify the width and height of the canvas using the width and height attributes on the element\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Everything drawn on the canvas is done using JavaScript\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Before you can draw on the canvas, you must first create a context that provides a kind of interface (e.g 2D).\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"To create a rectangle, use the context \",[\"$\",\"code\",null,{\"children\":\"fillRect()\"}],\" method. This draws a rectangle filled with color.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"To create a rectangle outline, use \",[\"$\",\"code\",null,{\"children\":\"strokeRect()\"}],\" method\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"to draw text in the canvas, use the \",[\"$\",\"code\",null,{\"children\":\"fillText()\"}],\" method. You can specify the position, color, style, and other text properties using context properties.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"When you set a context property, such as \",[\"$\",\"code\",null,{\"children\":\"fillStyle\"}],\", it applied to every drawing that follows until you change the property to a different value.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"To draw an image on the canvas, use the \",[\"$\",\"code\",null,{\"children\":\"drawImage()\"}],\" method.\"]}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"4b:[\"$\",\"hr\",null,{}]\n4c:[\"$\",\"nav\",null,{\"className\":\"post-navigation\",\"aria-label\":\"Post navigation\",\"children\":[[\"$\",\"h3\",null,{\"children\":\" Read other posts\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"$L10\",null,{\"href\":\"/blog/ux-writing-tips\",\"children\":[\"‚Üê \",\"9 UX writing tips for designers and developers\"]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"$L10\",null,{\"href\":\"/blog/download-canvas-image\",\"children\":[\"How to download an HTML5 canvas as an image using JavaScript\",\" ‚Üí\"]}]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1, maximum-scale=5\"}]]\n"])</script><script>self.__next_f.push([1,"4f:I[63559,[\"/_next/static/chunks/b42444546cf1924e.js\",\"/_next/static/chunks/8578e6e2b7d87452.js\"],\"IconMark\"]\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"title\",\"0\",{\"children\":\"Learn HTML5 canvas by building an image watermarking tool | Enjeck\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"HTML5 canvas allows us to create and manipulate pixels, just like a painter working on a canvas. We can draw text and graphics onto the canvas using JavaS\"}],[\"$\",\"link\",\"2\",{\"rel\":\"author\",\"href\":\"https://enjeck.github.io\"}],[\"$\",\"meta\",\"3\",{\"name\":\"author\",\"content\":\"Enjeck\"}],[\"$\",\"meta\",\"4\",{\"name\":\"keywords\",\"content\":\"JavaScript,HTML\"}],[\"$\",\"meta\",\"5\",{\"name\":\"creator\",\"content\":\"Enjeck\"}],[\"$\",\"meta\",\"6\",{\"name\":\"robots\",\"content\":\"index, follow\"}],[\"$\",\"meta\",\"7\",{\"name\":\"googlebot\",\"content\":\"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:title\",\"content\":\"Learn HTML5 canvas by building an image watermarking tool\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:description\",\"content\":\"HTML5 canvas allows us to create and manipulate pixels, just like a painter working on a canvas. We can draw text and graphics onto the canvas using JavaS\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"11\",{\"property\":\"article:published_time\",\"content\":\"2022-03-15\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:title\",\"content\":\"Learn HTML5 canvas by building an image watermarking tool\"}],[\"$\",\"meta\",\"14\",{\"name\":\"twitter:description\",\"content\":\"HTML5 canvas allows us to create and manipulate pixels, just like a painter working on a canvas. We can draw text and graphics onto the canvas using JavaS\"}],[\"$\",\"link\",\"15\",{\"rel\":\"icon\",\"href\":\"/favicon.ico?favicon.0b3bf435.ico\",\"sizes\":\"256x256\",\"type\":\"image/x-icon\"}],[\"$\",\"$L4f\",\"16\",{}]]\n"])</script><script>self.__next_f.push([1,"8:null\n"])</script></body></html>